<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Terraform and Terrascan with AWS (Immersive Labs)</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/stylesheet.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">Terraform and Terrascan with AWS (Immersive Labs)</h1>
</header><div id="outline-container-org6a81ddf" class="outline-2">
<h2 id="org6a81ddf">Immersive Labs</h2>
<div class="outline-text-2" id="text-org6a81ddf">

<figure id="org79c0d2a">
<img src="https://icon.icepanel.io/Technology/svg/HashiCorp-Terraform.svg" alt="HashiCorp-Terraform.svg" class="org-svg">

</figure>

<div class="PREVIEW" id="orgf03e772">
<p>
This post is going to cover my most recent lab "Secure Terraform for AWS". I wanted to present my personal approach on the lab and my experience in general. I'm going to try not to give away too much, just some hints and what to expect if you're considering purchasing licences or you're a learner considering which labs to do next.
</p>

</div>

<p>
For some time now I've been working through the Immersive Labs career pathways. My focus has been on Incident Response, Malicious File Analysis and Windows Malware, SIEM/Elastic and Event/Log Analysis. I've also completed a lot of the introductory labs that covers Security/Cyber Professional basics.
</p>

<p>
Having used some similar platforms like Hack the Box and the likes, I can say that the Immersive Labs are well designed with content that is thorough and excellent. If I find myself a bit lost at any point, I can easily flip to the guidance tab and after some perseverance manage to finish the labs with little frustration.
</p>
</div>
</div>
<div id="outline-container-orgda52bd2" class="outline-2">
<h2 id="orgda52bd2">Terraform for AWS</h2>
<div class="outline-text-2" id="text-orgda52bd2">
<p>
A quick reminder of what Terraform does:
</p>

<blockquote>
<p>
Terraform is an open-source tool developed by HashiCorp. Infrastructure is defined in a human-readable format in HashiCorp Language (HCL) or JSON which is processed by Terraform and then deployed into the appropriate target â€“ typically cloud. It's a popular way for companies to manage their infrastructure as code (IaC) and can be used in conjunction with most existing cloud providers. In this lab, we take a look at Terraform in the context of AWS.
</p>
</blockquote>

<p>
When you start the lab you'll get an overview of both Terraform and Terrascan. Make sure that you read through the information in order to become accustomed as to how they both work and integrate.
</p>



<figure id="orgb677a4f">
<img src="../img/tfexample.png" alt="tfexample.png" style="margin:auto; display:block; width:100%">

<figcaption><span class="figure-number">Figure 1: </span>What the console looks like</figcaption>
</figure>
</div>
<div id="outline-container-org16cda4f" class="outline-3">
<h3 id="org16cda4f">Episode 1</h3>
<div class="outline-text-3" id="text-org16cda4f">
<p>
The first labs starts with a simple S3 bucket configuration with some missing scopes/resources. Your job is to make sure that the Terraform HCL passes the Terrascan expected configuration so that the bucket is secure and meets the following expectations:
</p>

<ul class="org-ul">
<li>Server-side encryption should be enabled</li>
<li>Public access should not be granted</li>
<li>Buckets should be private</li>
<li>Access logging should be enabled and configured to log to another bucket</li>
<li>Objects should be owned by the bucket owner if they have been uploaded with the bucket-owner-full-control canned ACL</li>
</ul>


<figure id="orga15f08c">
<img src="../img/tfexample3.png" alt="tfexample3.png" style="margin:auto; display:block; width:100%">

<figcaption><span class="figure-number">Figure 2: </span>The auto-complete chooser is going to be your friend here ðŸ˜‰</figcaption>
</figure>

<p>
You're going to want to try a validate first in order to get feedback from Terrascan as to what's missing, unless you can tell off the bat and have previous experience in TF. The terminal response is really useful and I used the pointers to look at the official docs in order to work out which Key Value pair was needed.
</p>


<figure id="org0728a46">
<img src="../img/tfexample1.png" alt="tfexample1.png" style="margin:auto; display:block; width:100%">

<figcaption><span class="figure-number">Figure 3: </span>Example of Terrascan in action</figcaption>
</figure>
</div>
</div>
<div id="outline-container-org298c9a7" class="outline-3">
<h3 id="org298c9a7">Episode 2</h3>
<div class="outline-text-3" id="text-org298c9a7">
<p>
Covers KMS keys which are cryptographic keys that can be used to encrypt and secure AWS resources. EBS is also covered in this session which is for scalable block storage and is used as the default when creating volumes for EC2.
</p>

<p>
As above, I went with the terminal feedback first, by running validate. This gave me the missing resources and configurations I needed to target. The Terraform documents are very clear, respect to Hashicorp for that.
</p>


<figure id="orgc7a1283">
<img src="../img/tfexample2.png" alt="tfexample2.png" style="margin:auto; display:block; width:100%">

<figcaption><span class="figure-number">Figure 4: </span>More action</figcaption>
</figure>

<p>
In summary:
</p>

<ul class="org-ul">
<li>Run <code>terraform validate</code> to ensure that declarations are not missing arguments</li>
<li>Use Terrascan to identify potential security issues and syntax errors</li>
</ul>

<p>
I feel this episode was slightly easier and definitely had less points to address.
</p>
</div>
</div>
<div id="outline-container-orgf5d9289" class="outline-3">
<h3 id="orgf5d9289">Episode 3</h3>
<div class="outline-text-3" id="text-orgf5d9289">
<p>
This episode touches on the Aurora and Relational Database Services (RDS) in AWS. The brief covers the basics of the services and what to look out for in the lab. The goal is to correct the errors and update the resources to securely deploy infrastructure associated with the AWS Aurora service for relational databases (DBs).
</p>

<p>
This lab has a high and medium alert reported in Terrascan:
</p>

<ul class="org-ul">
<li><b>High</b> <code>aws_rds_cluster.aurora:#36</code></li>
<li><b>Medium</b> <code>aws_rds_cluster_instance.aurora:#49</code></li>
</ul>
</div>
</div>
<div id="outline-container-org1368675" class="outline-3">
<h3 id="org1368675">Episode 4 - the finale</h3>
<div class="outline-text-3" id="text-org1368675">
<p>
We reach the final episode which brings some more general security fundamentals and enabling detailed monitoring. Here we learn about how we restrict AWS VPC traffic to EC2 instances by using security groups and custom rules. EC2â€™s instance metadata service (IMDS) can be used to retrieve metadata about running EC2 instances from within the instance.
</p>

<blockquote>
<p>
This allows applications running within the instance to access temporary, rotated credentials, avoiding the need for developers to hardcode credentials. However, this metadata should not be available from outside the instance. IMDSv2 ensures that every request to the service is protected by session authentication where session tokens, unusable from outside the instance, are used to create temporary passwords for requests to the metadata service.
</p>
</blockquote>

<p>
I found this lab slightly more tricky as it was dealing with areas of AWS and resources, data blocks and configuration I'm less familiar with. However the terminal response of Terrascan made the experience fairly straight forward and that paired with using the excellent documentation offered made the Lab enjoyable, informative and filled in some blanks.
</p>
</div>
</div>
</div>
<div id="outline-container-orgbb74d60" class="outline-2">
<h2 id="orgbb74d60">Terrascan by Tenable</h2>
<div class="outline-text-2" id="text-orgbb74d60">
<p>
<a href="https://github.com/tenable/terrascanlink">Terrascan GitHub</a>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<div class="postamble">
               <p> Created by <a href="https://www.gnu.org/software/emacs/">Emacs</a> 30.1 (<a href="https://orgmode.org">Org</a> mode 9.7.11)  </p>
               </div>
</div>
</body>
</html>
